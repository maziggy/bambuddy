(function(){"use strict";const n=self,s=new Set,a=new Map;n.onmessage=async r=>{const e=r.data;switch(e.type){case"visibility":{e.visible?s.add(e.printerId):s.delete(e.printerId);break}case"frame":{const t=e.printerId,o=e.jpeg;if(!s.has(t))break;const c=(a.get(t)??0)+1;a.set(t,c);try{const p=new Blob([o],{type:"image/jpeg"}),i=await createImageBitmap(p);if(a.get(t)!==c){i.close();break}n.postMessage({type:"frame",printerId:t,bitmap:i},[i])}catch{}break}}}})();
